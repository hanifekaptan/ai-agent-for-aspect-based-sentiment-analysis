{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Aspectify","text":"<p>Welcome to Aspectify - A powerful Aspect-Based Sentiment Analysis (ABSA) system powered by Google's Gemini AI.</p>"},{"location":"#overview","title":"Overview","text":"<p>Aspectify is a production-ready application that extracts aspects (features/topics) from text and analyzes the sentiment (positive/negative/neutral) associated with each aspect. It's designed for analyzing customer reviews, feedback, and opinions at a granular level.</p>"},{"location":"#key-features","title":"Key Features","text":"<ul> <li>\ud83c\udfaf Aspect Extraction: Automatically identifies key topics and features mentioned in text</li> <li>\ud83d\ude0a Sentiment Analysis: Determines sentiment for each extracted aspect</li> <li>\ud83d\udcca Batch Processing: Handles single texts or bulk CSV uploads efficiently</li> <li>\ud83c\udf0d Multi-language Support: Auto-detects language (Turkish, English, etc.)</li> <li>\u26a1 Fast &amp; Scalable: Async processing with concurrent batch handling</li> <li>\ud83c\udfa8 Interactive Frontend: Beautiful Streamlit UI with visualizations</li> <li>\ud83d\udcc8 Export Options: Download results as CSV or Excel</li> </ul>"},{"location":"#use-cases","title":"Use Cases","text":"<ul> <li>Product Reviews: Analyze what customers love or hate about specific product features</li> <li>Service Feedback: Understand satisfaction levels across different service aspects</li> <li>Brand Monitoring: Track sentiment changes for various brand attributes</li> <li>Market Research: Extract insights from survey responses and feedback forms</li> </ul>"},{"location":"#quick-start","title":"Quick Start","text":""},{"location":"#installation","title":"Installation","text":"<pre><code># Clone repository\ngit clone https://github.com/hanifekaptan/ai-agent-for-aspect-based-sentiment-analysis\n.git\ncd ai-agent-for-aspect-based-sentiment-analysis\n\n# Create virtual environment\npython -m venv .venv\n.venv\\Scripts\\Activate.ps1  # Windows\nsource .venv/bin/activate    # Linux/Mac\n\n# Install dependencies\npip install -r requirements.txt\n</code></pre>"},{"location":"#running-the-application","title":"Running the Application","text":"<p>Backend API: <pre><code>uvicorn app.main:app --reload --reload-dir app\n</code></pre></p> <p>Frontend UI: <pre><code>streamlit run frontend/app.py\n</code></pre></p>"},{"location":"#example","title":"Example","text":"<p>Input: <pre><code>The phone's screen is amazing but the battery drains too quickly.\n</code></pre></p> <p>Output: <pre><code>{\n  \"id\": \"1\",\n  \"aspects\": [\n    {\"term\": \"screen\", \"sentiment\": \"positive\"},\n    {\"term\": \"battery\", \"sentiment\": \"negative\"}\n  ]\n}\n</code></pre></p>"},{"location":"#architecture","title":"Architecture","text":"<p>The system consists of three main components:</p> <ol> <li>FastAPI Backend: RESTful API for analysis requests</li> <li>Streamlit Frontend: Interactive web interface with visualizations</li> <li>LLM Integration: Google Gemini for aspect extraction and sentiment classification</li> </ol> <p>See the Architecture page for detailed system design.</p>"},{"location":"#api-reference","title":"API Reference","text":"<p>For detailed API endpoints and usage, see the API Reference page.</p>"},{"location":"#technology-stack","title":"Technology Stack","text":"<ul> <li>Backend: FastAPI, Python 3.10+</li> <li>LLM: Google Gemini (via LangChain)</li> <li>Frontend: Streamlit, Plotly</li> <li>Data Processing: Pandas, Jinja2</li> <li>Testing: Pytest</li> </ul>"},{"location":"#license","title":"License","text":"<p>This project is licensed under the Apache License.</p>"},{"location":"#contributing","title":"Contributing","text":"<p>Contributions are welcome! Please feel free to submit a Pull Request.</p>"},{"location":"#support","title":"Support","text":"<p>For issues and questions, please open an issue on GitHub.</p>"},{"location":"api/","title":"API Reference","text":"<p>Complete API documentation for the Aspectify backend service.</p>"},{"location":"api/#base-url","title":"Base URL","text":"<pre><code>http://localhost:8000\n</code></pre>"},{"location":"api/#endpoints","title":"Endpoints","text":""},{"location":"api/#health-check","title":"Health Check","text":"<p>Check if the API is running and healthy.</p> <p>Endpoint: <code>GET /health</code></p> <p>Response:</p> <pre><code>{\n  \"status\": \"healthy\",\n  \"timestamp\": \"2026-01-14T10:30:00Z\"\n}\n</code></pre> <p>Status Codes: - <code>200 OK</code>: Service is healthy</p>"},{"location":"api/#analyze-textcsv","title":"Analyze Text/CSV","text":"<p>Perform aspect-based sentiment analysis on text or CSV data.</p> <p>Endpoint: <code>POST /analyze</code></p> <p>Content-Type: <code>multipart/form-data</code></p>"},{"location":"api/#request-parameters","title":"Request Parameters","text":"Parameter Type Required Description <code>text</code> string No* Single text for analysis <code>upload_file</code> file No* CSV file (must have .csv extension) <p>*Note: Either <code>text</code> OR <code>upload_file</code> must be provided, not both.</p>"},{"location":"api/#csv-format-requirements","title":"CSV Format Requirements","text":"<p>Required Columns: - <code>id</code>: Unique identifier for each row - <code>comments</code>: Text content to analyze</p> <p>Example CSV: <pre><code>id,comments\n1,The screen is amazing but battery life is poor\n2,Camera quality is excellent and price is reasonable\n3,Customer service was terrible but product is good\n</code></pre></p> <p>Column Rules: - If CSV has single column without header, it's treated as comments - If CSV has multiple columns but no 'comments' column, returns error - Missing 'id' column: auto-generates sequential IDs</p>"},{"location":"api/#response-format","title":"Response Format","text":"<pre><code>{\n  \"items_submitted\": 3,\n  \"batches_sent\": 1,\n  \"results\": [\n    {\n      \"id\": \"1\",\n      \"aspects\": [\n        {\n          \"term\": \"screen\",\n          \"sentiment\": \"positive\"\n        },\n        {\n          \"term\": \"battery life\",\n          \"sentiment\": \"negative\"\n        }\n      ]\n    },\n    {\n      \"id\": \"2\",\n      \"aspects\": [\n        {\n          \"term\": \"camera quality\",\n          \"sentiment\": \"positive\"\n        },\n        {\n          \"term\": \"price\",\n          \"sentiment\": \"positive\"\n        }\n      ]\n    },\n    {\n      \"id\": \"3\",\n      \"aspects\": [\n        {\n          \"term\": \"customer service\",\n          \"sentiment\": \"negative\"\n        },\n        {\n          \"term\": \"product\",\n          \"sentiment\": \"positive\"\n        }\n      ]\n    }\n  ],\n  \"duration_seconds\": 1.45\n}\n</code></pre>"},{"location":"api/#response-fields","title":"Response Fields","text":"Field Type Description <code>items_submitted</code> integer Number of items processed <code>batches_sent</code> integer Number of batches sent to LLM <code>results</code> array Analysis results for each item <code>results[].id</code> string Item identifier <code>results[].aspects</code> array Extracted aspects with sentiments <code>results[].aspects[].term</code> string Aspect term/feature <code>results[].aspects[].sentiment</code> string Sentiment: <code>positive</code>, <code>negative</code>, or <code>neutral</code> <code>duration_seconds</code> float Total processing time"},{"location":"api/#status-codes","title":"Status Codes","text":"Code Description <code>200 OK</code> Successful analysis <code>400 Bad Request</code> Invalid input format or missing required fields <code>422 Unprocessable Entity</code> Invalid file format or CSV structure <code>500 Internal Server Error</code> Server error during processing <code>503 Service Unavailable</code> LLM quota exceeded or external service unavailable"},{"location":"api/#error-response-format","title":"Error Response Format","text":"<pre><code>{\n  \"detail\": \"Error message in Turkish\"\n}\n</code></pre> <p>Common Error Messages:</p> Error Cause <code>Metin veya CSV dosyas\u0131 gerekli!</code> Neither text nor file provided <code>Sadece .csv dosyalar\u0131 kabul edilir!</code> Non-CSV file uploaded <code>CSV dosyas\u0131nda 'comments' s\u00fctunu bulunamad\u0131!</code> Missing required column <code>Kota a\u015f\u0131ld\u0131 veya servis kullan\u0131lam\u0131yor</code> LLM quota exceeded"},{"location":"api/#example-usage","title":"Example Usage","text":""},{"location":"api/#curl-text-input","title":"cURL - Text Input","text":"<pre><code>curl -X POST \"http://localhost:8000/analyze\" \\\n  -F \"text=The phone screen is beautiful but battery dies quickly\"\n</code></pre>"},{"location":"api/#curl-csv-upload","title":"cURL - CSV Upload","text":"<pre><code>curl -X POST \"http://localhost:8000/analyze\" \\\n  -F \"upload_file=@reviews.csv\"\n</code></pre>"},{"location":"api/#python-requests","title":"Python - requests","text":"<pre><code>import requests\n\n# Text analysis\nresponse = requests.post(\n    \"http://localhost:8000/analyze\",\n    data={\"text\": \"Great camera but poor battery life\"}\n)\nresults = response.json()\n\n# CSV analysis\nwith open(\"reviews.csv\", \"rb\") as f:\n    response = requests.post(\n        \"http://localhost:8000/analyze\",\n        files={\"upload_file\": f}\n    )\n    results = response.json()\n</code></pre>"},{"location":"api/#rate-limiting","title":"Rate Limiting","text":"<p>The system uses internal semaphore-based concurrency control:</p> <ul> <li>Max Concurrent Batches: 3</li> <li>Batch Size: 10 items</li> <li>Retry Logic: None (fails fast on quota errors)</li> </ul> <p>Quota Exceeded Handling: - Returns <code>503 Service Unavailable</code> - Error message: <code>\"Kota a\u015f\u0131ld\u0131 veya servis kullan\u0131lam\u0131yor\"</code> - Client should implement exponential backoff</p>"},{"location":"api/#data-processing-pipeline","title":"Data Processing Pipeline","text":"<pre><code>Input \u2192 Validation \u2192 Parsing \u2192 Normalization \u2192 Batching \u2192 LLM \u2192 Parsing \u2192 Response\n</code></pre> <p>Steps:</p> <ol> <li>Validation: Check file type, required parameters</li> <li>Parsing: Convert input to standardized dict format</li> <li>Normalization: Map column names, generate IDs, detect language</li> <li>Batching: Split into fixed-size batches (default: 10)</li> <li>LLM Processing: Async calls to Gemini with prompt template</li> <li>Output Parsing: Parse TOON format to structured JSON</li> <li>Response: Aggregate results with metadata</li> </ol>"},{"location":"api/#language-support","title":"Language Support","text":"<p>Auto-Detection: - Language is automatically detected for each text - Supported languages: Turkish, English, and others via LangDetect - Language info used in prompt rendering</p> <p>Language Field (Internal): <pre><code>{\n    \"id\": \"1\",\n    \"comment\": \"Great product\",\n    \"language\": (\"en\", 0.99)  # (language_code, confidence)\n}\n</code></pre></p>"},{"location":"api/#text-sanitization","title":"Text Sanitization","text":"<p>All input text is automatically sanitized before processing:</p> <p>Sanitization Steps: 1. Unicode normalization (NFKC) 2. Whitespace normalization (collapse multiple spaces) 3. Word-boundary truncation (max 500 chars by default) 4. Delimiter escaping (<code>L:</code> prefix removal) 5. Control character removal</p> <p>Example: <pre><code># Before\n\"Great   screen\uff01\uff01\uff01\\n\\nL:test\"\n\n# After  \n\"Great screen!!! test\"\n</code></pre></p>"},{"location":"api/#testing","title":"Testing","text":"<p>Interactive API Docs:</p> <p>FastAPI provides automatic interactive documentation:</p> <ul> <li>Swagger UI: http://localhost:8000/docs</li> <li>ReDoc: http://localhost:8000/redoc</li> </ul> <p>Use these interfaces to test API endpoints directly in your browser.</p>"},{"location":"api/#error-handling","title":"Error Handling","text":""},{"location":"api/#client-errors-4xx","title":"Client Errors (4xx)","text":"<p>400 Bad Request: <pre><code>{\n  \"detail\": \"Metin veya CSV dosyas\u0131 gerekli!\"\n}\n</code></pre></p> <p>422 Unprocessable Entity: <pre><code>{\n  \"detail\": \"CSV dosyas\u0131nda 'comments' s\u00fctunu bulunamad\u0131!\"\n}\n</code></pre></p>"},{"location":"api/#server-errors-5xx","title":"Server Errors (5xx)","text":"<p>500 Internal Server Error: <pre><code>{\n  \"detail\": \"\u0130\u015flem s\u0131ras\u0131nda bir hata olu\u015ftu\"\n}\n</code></pre></p> <p>503 Service Unavailable: <pre><code>{\n  \"detail\": \"Kota a\u015f\u0131ld\u0131 veya servis kullan\u0131lam\u0131yor\"\n}\n</code></pre></p>"},{"location":"api/#best-practices","title":"Best Practices","text":"<ol> <li>Batch Processing:</li> <li>Upload CSV files for bulk analysis</li> <li>Aim for 10-50 items per request for optimal performance</li> <li> <p>Too many items may cause timeout</p> </li> <li> <p>Text Quality:</p> </li> <li>Provide complete sentences for better aspect extraction</li> <li>Avoid very short texts (&lt; 10 chars)</li> <li> <p>Remove excessive special characters</p> </li> <li> <p>CSV Format:</p> </li> <li>Always include 'id' and 'comments' columns</li> <li>Use UTF-8 encoding</li> <li> <p>Keep comments concise (&lt; 500 chars recommended)</p> </li> <li> <p>Error Handling:</p> </li> <li>Implement retry logic with exponential backoff for 503 errors</li> <li>Validate CSV structure before upload</li> <li> <p>Handle network timeouts gracefully</p> </li> <li> <p>Performance:</p> </li> <li>Use async clients for concurrent requests</li> <li>Cache results when appropriate</li> <li>Monitor response times and adjust batch sizes</li> </ol>"},{"location":"api/#versioning","title":"Versioning","text":"<p>Current Version: v1</p> <p>API Stability: Stable</p> <p>Breaking Changes: None planned</p> <p>Deprecation Policy: 6-month notice for any breaking changes</p>"},{"location":"api/#support","title":"Support","text":"<ul> <li>Issues: GitHub Issues</li> <li>Documentation: Full Docs</li> <li>Email: hanifekaptan.dev@gmail.com</li> </ul>"},{"location":"architecture/","title":"Architecture","text":"<p>This document describes the system architecture and design decisions of Aspectify.</p>"},{"location":"architecture/#system-overview","title":"System Overview","text":"<p>Aspectify is built on a modular, layered architecture separating concerns across backend API, frontend UI, and external LLM services.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    Frontend (Streamlit)                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502 Input Handler\u2502  \u2502Visualizations\u2502  \u2502  API Client  \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                             \u2502 HTTP REST API\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   Backend (FastAPI)                     \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502   API Layer  \u2502  \u2502    Service   \u2502  \u2502    Utils     \u2502 \u2502\n\u2502  \u2502   (Routes)   \u2502  \u2502     Layer    \u2502  \u2502   (Parsers)  \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                             \u2502 LangChain API\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502               External LLM (Google Gemini)              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/#backend-architecture","title":"Backend Architecture","text":""},{"location":"architecture/#layer-structure","title":"Layer Structure","text":"<p>1. API Layer (<code>app/api/</code>) - Purpose: HTTP request handling and response formatting - Components:   - <code>analyze.py</code>: Main analysis endpoint accepting text or CSV   - <code>health.py</code>: Health check endpoint   - <code>routers.py</code>: Router configuration and registration - Responsibilities:   - Request validation   - File upload handling   - Error response formatting   - Turkish error messages</p> <p>2. Service Layer (<code>app/services/</code>) - Purpose: Business logic orchestration - Components:   - <code>absa_service.py</code>: Main ABSA orchestrator - Responsibilities:   - Input parsing via utils   - Item normalization   - Batch processing coordination   - Async LLM calls with semaphore-based concurrency   - Response aggregation   - Quota error handling</p> <p>3. Utility Layer (<code>app/utils/</code>) - Purpose: Data transformation and validation - Components:   - <code>parsers.py</code>: Input/output parsing   - <code>sanitizer.py</code>: Text cleaning and normalization   - <code>language_detector.py</code>: Language detection - Key Functions:   - <code>parse_data()</code>: Converts text/CSV to standardized dict format   - <code>create_df()</code>: DataFrame validation and column standardization   - <code>toon_to_dicts()</code>: Parses TOON format LLM outputs   - <code>sanitize_comment()</code>: Cleans text (Unicode, truncation, delimiter escaping)</p> <p>4. Prompting Layer (<code>app/prompting/</code>) - Purpose: Prompt management and rendering - Components:   - <code>manager.py</code>: Prompt loading, rendering, normalization   - <code>minifiers.py</code>: Prompt compression - Features:   - YAML-based prompt templates   - Jinja2 template rendering   - Item normalization (comments\u2192comment, language handling, ID generation)</p> <p>5. LLM Integration (<code>app/llm/</code>) - Purpose: External AI model communication - Components:   - <code>client.py</code>: LangChain Google GenAI wrapper - Configuration:   - Model: <code>gemini-1.5-flash</code>   - Temperature: 0.0 (deterministic)   - Max tokens: 8192</p>"},{"location":"architecture/#data-flow","title":"Data Flow","text":"<pre><code>1. User Input (text or CSV)\n   \u2193\n2. API Layer: Validation &amp; File Handling\n   \u2193\n3. Service Layer: parse_data() \u2192 normalize_items()\n   \u2193\n4. Prompting: Render Jinja2 template with items\n   \u2193\n5. LLM Client: Send batch to Gemini\n   \u2193\n6. Parsing: toon_to_dicts() extracts aspects\n   \u2193\n7. Response: JSON with aspects per item\n</code></pre>"},{"location":"architecture/#frontend-architecture","title":"Frontend Architecture","text":""},{"location":"architecture/#component-structure","title":"Component Structure","text":"<p>1. Entry Point (<code>frontend/app.py</code>) - Application routing - Sidebar rendering - CSS styling - Mode selection</p> <p>2. API Client (<code>frontend/api/client.py</code>) - <code>call_api_text()</code>: POST text to <code>/analyze</code> - <code>call_api_csv()</code>: POST CSV file to <code>/analyze</code> - Error handling and user feedback</p> <p>3. Input Handlers (<code>frontend/components/input_handlers.py</code>) - <code>handle_text_input()</code>: Single text form - <code>handle_csv_upload()</code>: CSV file upload with preview - <code>handle_sample_data()</code>: Demo with pre-loaded dataset - Callback pattern: <code>on_results(results, is_single)</code></p> <p>4. Visualizations (<code>frontend/components/visualizations.py</code>) - <code>display_results()</code>: Main orchestrator - <code>_display_summary_metrics()</code>: 4-column metrics - <code>_display_sentiment_pie_chart()</code>: Plotly pie chart - <code>_display_term_frequency_chart()</code>: Horizontal bar chart - <code>_display_aspect_sentiment_matrix()</code>: Grouped table with satisfaction % - <code>_display_detailed_results()</code>: Expandable item view - <code>_display_export_options()</code>: CSV/Excel download</p> <p>5. Assets (<code>frontend/assets/</code>) - <code>sample_data.csv</code>: 15 phone review samples</p>"},{"location":"architecture/#data-formats","title":"Data Formats","text":""},{"location":"architecture/#input-formats","title":"Input Formats","text":"<p>Text Input: <pre><code>{\n    \"text\": \"The screen is great but battery drains fast.\"\n}\n</code></pre></p> <p>CSV Input: <pre><code>id,comments\n1,The screen is great but battery drains fast.\n2,Camera quality is excellent.\n</code></pre></p>"},{"location":"architecture/#toon-output-format","title":"TOON Output Format","text":"<p>Compact line-based format from LLM:</p> <pre><code>L:&lt;id&gt;|TERM~SENT;;TERM2~SENT2\n</code></pre> <p>Example: <pre><code>L:1|screen~positive;;battery~negative\nL:2|camera~positive\n</code></pre></p> <p>Format Rules: - Each line starts with <code>L:&lt;id&gt;|</code> - Aspects separated by <code>;;</code> - Term and sentiment separated by <code>~</code> - Sentiments: <code>positive</code>, <code>negative</code>, <code>neutral</code></p>"},{"location":"architecture/#api-response-format","title":"API Response Format","text":"<pre><code>{\n  \"items_submitted\": 2,\n  \"batches_sent\": 1,\n  \"results\": [\n    {\n      \"id\": \"1\",\n      \"aspects\": [\n        {\"term\": \"screen\", \"sentiment\": \"positive\"},\n        {\"term\": \"battery\", \"sentiment\": \"negative\"}\n      ]\n    },\n    {\n      \"id\": \"2\",\n      \"aspects\": [\n        {\"term\": \"camera\", \"sentiment\": \"positive\"}\n      ]\n    }\n  ],\n  \"duration_seconds\": 1.23\n}\n</code></pre>"},{"location":"architecture/#design-decisions","title":"Design Decisions","text":""},{"location":"architecture/#1-toon-format-over-json","title":"1. TOON Format Over JSON","text":"<p>Rationale: - Reduces token usage (~40% savings) - Simpler for LLM to generate - Easier to parse with regex patterns - More compact for batch processing</p> <p>Trade-off: Slightly more complex parsing logic</p>"},{"location":"architecture/#2-async-batch-processing","title":"2. Async Batch Processing","text":"<p>Implementation: <pre><code>semaphore = asyncio.Semaphore(3)  # Max 3 concurrent requests\n</code></pre></p> <p>Rationale: - Prevents quota exhaustion - Better error handling per batch - Maintains order for results - Graceful degradation on failures</p>"},{"location":"architecture/#3-manager-based-normalization","title":"3. Manager-Based Normalization","text":"<p>Rationale: - Centralized item transformation logic - Consistent behavior across service calls - Easier to test and maintain - Handles edge cases (missing IDs, language tuples)</p>"},{"location":"architecture/#4-evidence-removal","title":"4. Evidence Removal","text":"<p>Decision: Originally extracted evidence, now removed</p> <p>Rationale: - Not needed for most use cases - Reduces LLM output complexity - Faster processing - Lower token costs</p> <p>Migration: Simplified <code>toon_to_dicts()</code> from ~60 to ~25 lines</p>"},{"location":"architecture/#5-csv-first-approach","title":"5. CSV-First Approach","text":"<p>Decision: CSV uploads with strict validation (id, comments columns)</p> <p>Rationale: - Standard format for bulk data - Easy to validate and preview - Supports batch workflows - Familiar to business users</p> <p>Fallback: Single text input also supported</p>"},{"location":"architecture/#6-tolerant-parsing","title":"6. Tolerant Parsing","text":"<p>Implementation: <pre><code># Handles whitespace, blank lines, malformed entries\nline = line.strip()\nif not line or not line.startswith('L:'):\n    continue\n</code></pre></p> <p>Rationale: - LLMs occasionally produce extra whitespace - Partial results better than full failure - Graceful degradation improves UX</p>"},{"location":"architecture/#security-considerations","title":"Security Considerations","text":"<ol> <li>Input Sanitization:</li> <li>Unicode normalization (NFKC)</li> <li>Delimiter escaping</li> <li>Control character removal</li> <li> <p>Max length truncation</p> </li> <li> <p>File Upload Validation:</p> </li> <li>CSV extension check</li> <li>Column presence validation</li> <li> <p>Pandas safe parsing</p> </li> <li> <p>Error Handling:</p> </li> <li>No stack traces exposed to users</li> <li>Generic error messages for external failures</li> <li>Quota errors handled specifically</li> </ol>"},{"location":"architecture/#performance-optimization","title":"Performance Optimization","text":"<ol> <li>Batch Processing:</li> <li>Fixed-size batches (default: 10 items)</li> <li>Async concurrency with semaphore</li> <li> <p>Avoids token counting overhead</p> </li> <li> <p>Prompt Efficiency:</p> </li> <li>TOON format reduces tokens</li> <li>Minimal instructions</li> <li> <p>Examples only when needed</p> </li> <li> <p>Frontend Caching:</p> </li> <li>Streamlit session state for results</li> <li>Avoid re-rendering on interactions</li> <li>Lazy loading for detailed views</li> </ol>"},{"location":"architecture/#testing-strategy","title":"Testing Strategy","text":"<ul> <li>Unit Tests: Core utilities (parsers, sanitizer, manager)</li> <li>Integration Tests: Service layer with mock LLM</li> <li>Coverage Target: &gt;80% for critical paths</li> <li>Test Files:</li> <li><code>tests/unit/test_parsers.py</code></li> <li><code>tests/unit/test_sanitizer.py</code></li> <li><code>tests/unit/test_manager.py</code></li> <li><code>tests/unit/test_toon_parser.py</code></li> </ul>"},{"location":"architecture/#deployment-considerations","title":"Deployment Considerations","text":"<ul> <li>Environment Variables: API keys via <code>.env</code> file</li> <li>Process Management: Uvicorn with auto-reload</li> <li>Monitoring: Health check endpoint at <code>/health</code></li> <li>Scalability: Stateless design enables horizontal scaling</li> </ul>"}]}